name: Lint and Format Checks

on:
  pull_request:
    paths:
      - '**.sh'
      - '**.md'
  push:
    branches: [ main ]

jobs:
  shellcheck:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Install ShellCheck
        run: sudo apt-get update && sudo apt-get install -y shellcheck
      - name: Run ShellCheck
        run: |
          shellcheck -x setup_master.sh install.sh mhs35_setup.sh
          shellcheck -x scripts/*.sh
          shellcheck -x POST_INSTALL/*.sh
          shellcheck -x tests/*.sh
        continue-on-error: true

  markdown-lint:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Install markdownlint
        run: sudo npm install -g markdownlint-cli
      - name: Run Markdown Lint
        run: |
          markdownlint README.md CHANGELOG.md
          markdownlint docs/*.md || true
        continue-on-error: true

  bash-syntax:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Check bash syntax
        run: |
          bash -n setup_master.sh install.sh mhs35_setup.sh
          bash -n scripts/*.sh
          bash -n POST_INSTALL/*.sh
          bash -n tests/*.sh
